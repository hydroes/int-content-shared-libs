"use strict";var _=require("underscore");dust.helpers.imgcdn=function(e,r,t,a){var o="";if(!a.asset)return e.write(o);var i=r.get("global.protocol"),l=r.get("global.images.domain"),s=r.get("global.images.quality"),n=r.resolve(a.asset),p="{protocol}{domain}/{path}/{fileName}";p=p.replace("{protocol}",i),p=p.replace("{domain}",l),p=p.replace("{path}",n.path||""),p=p.replace("{fileName}",encodeURIComponent(n.fileName)||"");var c,u=["quality","trim","trimFuzz","width","height","cropX","cropY","ratio","devicePixelRatio","gravity","filter","blur","strip","rotate","flip","srcData","resizeStyle"];if(a.cropData&&a.cropType){var g={_field:a.cropType},v=_.findWhere(a.cropData,g);if(!v){var f=_.first(a.cropData);f&&f._image&&(v=f)}"object"==typeof v&&null!==v&&(c=[],c.top=parseInt(v.y),c.left=parseInt(v.x),c.bottom=parseInt(v.y+v.height),c.right=parseInt(v.x+v.width),u.push("crop"))}for(var h="?",d=!1,m=u.length,y=0;y<m;y++){var b=r.resolve(a[u[y]]);"crop"===u[y]&&void 0===b&&(b=c.top+","+c.left+","+c.bottom+","+c.right),"quality"===u[y]&&void 0===b&&(b=s),void 0!==b&&(!0===d&&(h="&"),p+=h+u[y]+"={"+b+"}",p=p.replace("{"+b+"}",b),d=!0)}return void 0!==c&&(p+="&resize=crop"),p+="&format=jpg",o=p,e.write(o)},dust.helpers.link=function(e,r,t,a){var o=r.resolve(a.article);return"/"+r.resolve(a.channel)+"/"+o.categories[0].parent.furl+"/"+o.categories[0].furl+"/"+o.furl},dust.helpers.primarySyndicate=function(e,r,t,a){for(var o=r.resolve(a.urls),i=r.resolve(a.channel),l="",s=o.length-1;s>=0;s--)o[s].split("/")[0]===i&&(console.log("Match",o[s].split("/")[0]+"| "+i),l="/"+o[s]);return l},dust.helpers.truncateString=function(e,r,t,a){var o="";if(a.string){var i=r.resolve(a.string),l=parseInt(r.resolve(a.length));try{o=i.length>l?i.substring(0,l)+"â€¦":i}catch(e){o=i}}return e.write(o)};